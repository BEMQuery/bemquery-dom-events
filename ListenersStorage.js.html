<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>ListenersStorage.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="BEMQuery.html">BEMQuery</a><ul class='methods'><li data-type='method'><a href="BEMQuery.html#off">off</a></li><li data-type='method'><a href="BEMQuery.html#on">on</a></li></ul></li><li><a href="ListenersStorage.html">ListenersStorage</a><ul class='methods'><li data-type='method'><a href="ListenersStorage.html#add">add</a></li><li data-type='method'><a href="ListenersStorage.html#get">get</a></li><li data-type='method'><a href="ListenersStorage.html#remove">remove</a></li></ul></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">ListenersStorage.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>'use strict';

/** Storage for events listeners */
class ListenersStorage {
	/**
	 * Creates new storage for event lsiteners
	 *
	 * @class
	 */
	constructor() {
		this.storage = new WeakMap();
	}

	/**
	 * Adds event listener to the storage.
	 *
	 * @param {Object} element Element to which listener is binded.
	 * @param {String} type Type of event.
	 * @param {String} selector Selector for event delegation.
	 * @param {Function} fn Original callback.
	 * @param {Function} listener Created listener.
	 * @return {void}
	 */
	add( element, type, selector, fn, listener ) {
		let listeners = {};

		if ( this.storage.has( element ) ) {
			listeners = this.storage.get( element );
		}

		if ( typeof listeners[ type ] === 'undefined' ) {
			listeners[ type ] = {};
		}

		if ( typeof listeners[ type ][ selector ] === 'undefined' ) {
			listeners[ type ][ selector ] = [];
		}

		listeners[ type ][ selector ].push( [ fn, listener ] );

		this.storage.set( element, listeners );
	}

	/**
	 * Gets event listener that matches the given criteria.
	 *
	 * @param {Object} element Element to which listener is binded.
	 * @param {String} type Type of event.
	 * @param {String} selector Selector for event delegation.
	 * @param {Function} fn Original callback.
	 * @return {Function} Event listener.
	 */
	get( element, type, selector, fn ) {
		if ( !this.storage.has( element ) ) {
			return null;
		}

		const listeners = this.storage.get( element );

		if ( typeof listeners[ type ] === 'undefined' || typeof listeners[ type ][ selector ] === 'undefined' ) {
			return null;
		}

		for ( let pair of listeners[ type ][ selector ] ) { // eslint-disable-line prefer-const
			if ( pair[ 0 ] === fn ) {
				return pair[ 1 ];
			}
		}

		return null;
	}

	/**
	 * Removes event listener that matches the given criteria.
	 *
	 * @param {Object} element Element to which listener is binded.
	 * @param {String} type Type of event.
	 * @param {String} selector Selector for event delegation.
	 * @param {Function} fn Original callback.
	 * @return {Function} Event listener.
	 */
	remove( element, type, selector, fn ) {
		if ( !this.storage.has( element ) ) {
			return null;
		}

		const listeners = this.storage.get( element );

		if ( typeof listeners[ type ] === 'undefined' || typeof listeners[ type ][ selector ] === 'undefined' ) {
			return null;
		}

		listeners[ type ][ selector ].forEach( ( pair, i ) => {
			if ( pair[ 0 ] === fn ) {
				listeners[ type ][ selector ].splice( i, 1 );
			}
		} );

		return null;
	}
}

export default ListenersStorage;
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.1</a> on Sat Sep 17 2016 19:37:42 GMT+0200 (CEST) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
